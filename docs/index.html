<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>GPT Detectors</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">GPT Detectors</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="disclaimer" class="level2">
<h2 class="anchored" data-anchor-id="disclaimer">Disclaimer</h2>
<p>This is a data analytics/science project, focusing on the analysis of a TidyTuesday project. I have no intention to influence in any way any AI and/or AI detector company.</p>
</section>
<section id="the-data" class="level2">
<h2 class="anchored" data-anchor-id="the-data">The Data</h2>
<p>The data comes from the 29th Tidy Tuesday Projects (see more:https://github.com/rfordatascience/tidytuesday) in 2023. The Data is based on the paper of Liang et al.’s (2023) paper, which investigates the reliability of the GPT detectors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytuesdayR)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(WRS2)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="the-data-1" class="level3">
<h3 class="anchored" data-anchor-id="the-data-1">The data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> <span class="fu">tt_load</span>(<span class="st">"2023-07-18"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>---- Compiling #TidyTuesday Information for 2023-07-18 ----
--- There is 1 file available ---


── Downloading files ───────────────────────────────────────────────────────────

  1 of 1: "detectors.csv"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dataset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "detectors"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>detectors <span class="ot">&lt;-</span> dataset<span class="sc">$</span>detectors</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(detectors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [6,185 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ kind       : chr [1:6185] "Human" "Human" "Human" "AI" ...
 $ .pred_AI   : num [1:6185] 0.999994 0.828145 0.000214 0 0.001784 ...
 $ .pred_class: chr [1:6185] "AI" "AI" "Human" "Human" ...
 $ detector   : chr [1:6185] "Sapling" "Crossplag" "Crossplag" "ZeroGPT" ...
 $ native     : chr [1:6185] "No" "No" "Yes" NA ...
 $ name       : chr [1:6185] "Real TOEFL" "Real TOEFL" "Real College Essays" "Fake CS224N - GPT3" ...
 $ model      : chr [1:6185] "Human" "Human" "Human" "GPT3" ...
 $ document_id: num [1:6185] 497 278 294 671 717 855 533 484 781 460 ...
 $ prompt     : chr [1:6185] NA NA NA "Plain" ...
 - attr(*, "spec")=
  .. cols(
  ..   kind = col_character(),
  ..   .pred_AI = col_double(),
  ..   .pred_class = col_character(),
  ..   detector = col_character(),
  ..   native = col_character(),
  ..   name = col_character(),
  ..   model = col_character(),
  ..   document_id = col_double(),
  ..   prompt = col_character()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(detectors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "spec_tbl_df" "tbl_df"      "tbl"         "data.frame" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>detectors_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(detectors)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(detectors_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   6185 obs. of  9 variables:
 $ kind       : chr  "Human" "Human" "Human" "AI" ...
 $ .pred_AI   : num  0.999994 0.828145 0.000214 0 0.001784 ...
 $ .pred_class: chr  "AI" "AI" "Human" "Human" ...
 $ detector   : chr  "Sapling" "Crossplag" "Crossplag" "ZeroGPT" ...
 $ native     : chr  "No" "No" "Yes" NA ...
 $ name       : chr  "Real TOEFL" "Real TOEFL" "Real College Essays" "Fake CS224N - GPT3" ...
 $ model      : chr  "Human" "Human" "Human" "GPT3" ...
 $ document_id: num  497 278 294 671 717 855 533 484 781 460 ...
 $ prompt     : chr  NA NA NA "Plain" ...</code></pre>
</div>
</div>
</section>
<section id="investigating-the-qualitiative-data" class="level3">
<h3 class="anchored" data-anchor-id="investigating-the-qualitiative-data">Investigating the Qualitiative data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(detectors_df<span class="sc">$</span>kind)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   AI Human 
 3717  2468 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(detectors_df<span class="sc">$</span>.pred_class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   AI Human 
 1607  4578 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(detectors_df<span class="sc">$</span>detector)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Crossplag       GPTZero      HFOpenAI OriginalityAI          Quil 
          925           925           925           925           780 
      Sapling       ZeroGPT 
          780           925 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>detectors_df<span class="sc">$</span>detector <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(detectors_df<span class="sc">$</span>detector)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(detectors_df<span class="sc">$</span>native)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  No  Yes 
 637 1831 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(detectors_df<span class="sc">$</span>name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                  Fake College Essays - GPT3 
                                         217 
Fake College Essays - GPT3 Prompt Engineered 
                                         217 
                          Fake CS224N - GPT3 
                                        1015 
                      Fake CS224N - GPT3, PE 
                                        1015 
                      Fake TOEFL - GPT4 - PE 
                                         637 
                         Real College Essays 
                                         490 
                                 Real CS224N 
                                         725 
                                  Real TOEFL 
                                         637 
                          US 8th grade essay 
                                         616 
           US 8th grade essay - GPT simplify 
                                         616 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>detectors_df<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(detectors_df<span class="sc">$</span>name)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(detectors_df<span class="sc">$</span>model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 GPT3  GPT4 Human 
 1449  2268  2468 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>detectors_df<span class="sc">$</span>model<span class="ot">&lt;-</span> <span class="fu">as.factor</span>(detectors_df<span class="sc">$</span>model)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(detectors_df<span class="sc">$</span>prompt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  Elevate using literary  Elevate using technical      Enhance like native 
                     217                     1015                      637 
                   Plain Simplify like non-native 
                    1232                      616 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>detectors_df<span class="sc">$</span>prompt<span class="ot">&lt;-</span> <span class="fu">as.factor</span>(detectors_df<span class="sc">$</span>prompt)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>detectors_df<span class="sc">$</span>native <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(detectors_df<span class="sc">$</span>native) </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co">#recoding native - making sure 1 is for yes and no for 0 </span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>detectors_df <span class="ot">&lt;-</span> detectors_df <span class="sc">%&gt;%</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">native_2 =</span> <span class="fu">case_when</span>(</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    native<span class="sc">==</span> <span class="st">"No"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    native<span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>))</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(detectors_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   6185 obs. of  10 variables:
 $ kind       : chr  "Human" "Human" "Human" "AI" ...
 $ .pred_AI   : num  0.999994 0.828145 0.000214 0 0.001784 ...
 $ .pred_class: chr  "AI" "AI" "Human" "Human" ...
 $ detector   : Factor w/ 7 levels "Crossplag","GPTZero",..: 6 1 1 7 4 3 3 1 7 6 ...
 $ native     : Factor w/ 2 levels "No","Yes": 1 1 2 NA NA 2 NA NA 2 1 ...
 $ name       : Factor w/ 10 levels "Fake College Essays - GPT3",..: 8 8 6 3 4 7 3 4 7 8 ...
 $ model      : Factor w/ 3 levels "GPT3","GPT4",..: 3 3 3 1 2 3 1 2 3 3 ...
 $ document_id: num  497 278 294 671 717 855 533 484 781 460 ...
 $ prompt     : Factor w/ 5 levels "Elevate using literary",..: NA NA NA 4 2 NA 4 2 NA NA ...
 $ native_2   : num  0 0 1 NA NA 1 NA NA 1 0 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#recoding .pred_cllass </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="investigating-the-quantitative-data" class="level3">
<h3 class="anchored" data-anchor-id="investigating-the-quantitative-data">Investigating the Quantitative data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(detectors_df<span class="sc">$</span>.pred_AI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   vars    n mean  sd median trimmed mad min max range skew kurtosis   se
X1    1 6185 0.27 0.4      0    0.21   0   0   1     1 1.06     -0.7 0.01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(detectors_df<span class="sc">$</span>document_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   vars    n   mean     sd median trimmed    mad min max range skew kurtosis
X1    1 6185 445.04 261.27    438  441.03 324.69   1 926   925 0.09    -1.11
     se
X1 3.32</code></pre>
</div>
</div>
</section>
<section id="missing-values" class="level3">
<h3 class="anchored" data-anchor-id="missing-values">Missing Values</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(detectors_df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       kind    .pred_AI .pred_class    detector      native        name 
          0           0           0           0        3717           0 
      model document_id      prompt    native_2 
          0           0        2468        3717 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># It is importasnt. to not impute the missing values, because in "native" variable: NA indicates that it was not written by a human. and in the "prompt" variable NA-s indicating real examinations (like Real TOEFL).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="first-model" class="level3">
<h3 class="anchored" data-anchor-id="first-model">First model</h3>
<p>In the first model I am using binary logistic regression. Where I am curious is a GPT detector detects non-native people as AI. ##Frequentist appproach #Baseline model_1</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>model_baseline<span class="ot">&lt;-</span> <span class="fu">glm</span>(native_2 <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data=</span> detectors_df, <span class="at">family=</span> <span class="st">"binomial"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="test-model_1" class="level3">
<h3 class="anchored" data-anchor-id="test-model_1">Test model_1</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>model_1<span class="ot">&lt;-</span> <span class="fu">glm</span>(native_2 <span class="sc">~</span> .pred_AI, <span class="at">data=</span> detectors_df, <span class="at">family=</span> <span class="st">"binomial"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_baseline, model_1, <span class="at">test=</span> <span class="st">"LRT"</span>) <span class="co">#&lt;- indicating significant diffference between the nullmodel and the testmodel</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: native_2 ~ 1
Model 2: native_2 ~ .pred_AI
  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
1      2467     2818.8                          
2      2466     1681.8  1   1136.9 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = native_2 ~ .pred_AI, family = "binomial", data = detectors_df)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  2.26933    0.07616   29.80   &lt;2e-16 ***
.pred_AI    -5.14785    0.20917  -24.61   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2818.8  on 2467  degrees of freedom
Residual deviance: 1681.8  on 2466  degrees of freedom
  (3717 observations deleted due to missingness)
AIC: 1685.8

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC: 1685.8423</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="bayesian-approach-building-the-bayes--null-model" class="level3">
<h3 class="anchored" data-anchor-id="bayesian-approach-building-the-bayes--null-model">Bayesian approach #Building the Bayes- null-model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>bayes_model_0 <span class="ot">&lt;-</span> <span class="fu">brm</span>(native_2 <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> detectors_df, </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family =</span> <span class="fu">bernoulli</span>(<span class="at">link =</span> <span class="st">"logit"</span>), <span class="at">seed=</span><span class="dv">123</span>,</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Rows containing NAs were excluded from the model.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Compiling Stan program...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Start sampling</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 8.5e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.85 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.176 seconds (Warm-up)
Chain 1:                0.189 seconds (Sampling)
Chain 1:                0.365 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 4.7e-05 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.47 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.176 seconds (Warm-up)
Chain 2:                0.181 seconds (Sampling)
Chain 2:                0.357 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 5e-05 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.5 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.178 seconds (Warm-up)
Chain 3:                0.182 seconds (Sampling)
Chain 3:                0.36 seconds (Total)
Chain 3: 

SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 5.2e-05 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.52 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.181 seconds (Warm-up)
Chain 4:                0.169 seconds (Sampling)
Chain 4:                0.35 seconds (Total)
Chain 4: </code></pre>
</div>
</div>
</section>
<section id="building-the-first-model" class="level3">
<h3 class="anchored" data-anchor-id="building-the-first-model">Building the first model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>bayes_model_1 <span class="ot">&lt;-</span> <span class="fu">brm</span>(native_2<span class="sc">~</span> .pred_AI, </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> detectors_df, </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family =</span> <span class="fu">bernoulli</span>(<span class="at">link =</span> <span class="st">"logit"</span>), <span class="at">seed=</span><span class="dv">123</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Rows containing NAs were excluded from the model.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Compiling Stan program...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Start sampling</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 3.4e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.34 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.117 seconds (Warm-up)
Chain 1:                0.098 seconds (Sampling)
Chain 1:                0.215 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 3e-05 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.3 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.114 seconds (Warm-up)
Chain 2:                0.12 seconds (Sampling)
Chain 2:                0.234 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 2.4e-05 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.24 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.116 seconds (Warm-up)
Chain 3:                0.106 seconds (Sampling)
Chain 3:                0.222 seconds (Total)
Chain 3: 

SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 2.7e-05 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.27 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.112 seconds (Warm-up)
Chain 4:                0.112 seconds (Sampling)
Chain 4:                0.224 seconds (Total)
Chain 4: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bayes_factor</span>(bayes_model_1,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>             bayes_model_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Iteration: 1
Iteration: 2
Iteration: 3
Iteration: 4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: effective sample size cannot be calculated, has been replaced by
number of samples.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Iteration: 1
Iteration: 2
Iteration: 3
Iteration: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Estimated Bayes factor in favor of bayes_model_1 over bayes_model_0: 5279469617055601319225400310393509906609598470346768029781914372405871340219842665494234462069276108848576295541789114125257943745732674642097960246791543689693205350613487233843060404115539685475025738604964026080978227099911492590842396966649856.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bayes_model_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: bernoulli 
  Links: mu = logit 
Formula: native_2 ~ .pred_AI 
   Data: detectors_df (Number of observations: 2468) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     2.27      0.08     2.12     2.42 1.00     3027     2327
.pred_AI     -5.16      0.21    -5.59    -4.76 1.00     3633     2381

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section id="visualisation" class="level3">
<h3 class="anchored" data-anchor-id="visualisation">Visualisation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>smooth_color <span class="ot">&lt;-</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">"viridis"</span>)(<span class="dv">1</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(detectors_df, <span class="fu">aes</span>(<span class="at">x=</span>.pred_AI,</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y=</span> native_2,</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> .pred_AI))<span class="sc">+</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">height =</span> .<span class="dv">05</span>,</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>,</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span><span class="st">"binomial"</span>),</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">se =</span> F,</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> smooth_color)<span class="sc">+</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Probability of the text is  AI generated."</span>, </span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span> <span class="st">"Native English or not"</span>)<span class="sc">+</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Non-Native"</span>, <span class="st">"Native"</span>))<span class="sc">+</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(),</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span><span class="dv">8</span>),</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>),</span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3717 rows containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3717 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/viz_1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here I am courius which detector detects the most of the text as GPT (more precisely: which detector gives higher probability that a text is written by AI)</p>
<p>#Normality check for question 2 with Shapiro-Wilk test</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">by</span>(detectors_df<span class="sc">$</span>.pred_AI, detectors_df<span class="sc">$</span>detector, <span class="cf">function</span>(x){<span class="fu">shapiro.test</span>(x)})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>detectors_df$detector: Crossplag

    Shapiro-Wilk normality test

data:  x
W = 0.62509, p-value &lt; 2.2e-16

------------------------------------------------------------ 
detectors_df$detector: GPTZero

    Shapiro-Wilk normality test

data:  x
W = 0.5182, p-value &lt; 2.2e-16

------------------------------------------------------------ 
detectors_df$detector: HFOpenAI

    Shapiro-Wilk normality test

data:  x
W = 0.62307, p-value &lt; 2.2e-16

------------------------------------------------------------ 
detectors_df$detector: OriginalityAI

    Shapiro-Wilk normality test

data:  x
W = 0.69843, p-value &lt; 2.2e-16

------------------------------------------------------------ 
detectors_df$detector: Quil

    Shapiro-Wilk normality test

data:  x
W = 0.68985, p-value &lt; 2.2e-16

------------------------------------------------------------ 
detectors_df$detector: Sapling

    Shapiro-Wilk normality test

data:  x
W = 0.63365, p-value &lt; 2.2e-16

------------------------------------------------------------ 
detectors_df$detector: ZeroGPT

    Shapiro-Wilk normality test

data:  x
W = 0.66345, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Equality of variances check with Levene-test</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(.pred_AI<span class="sc">~</span> detector, <span class="at">data=</span> detectors_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
        Df F value    Pr(&gt;F)    
group    6  40.552 &lt; 2.2e-16 ***
      6178                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Because both asumption did not met, I used Welch test on rang-numbers</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>wrs2 <span class="ot">&lt;-</span> <span class="fu">t1way</span>(.pred_AI<span class="sc">~</span> detector, <span class="at">data=</span> detectors_df, <span class="at">tr=</span> <span class="fl">0.2</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(wrs2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
t1way(formula = .pred_AI ~ detector, data = detectors_df, tr = 0.2)

Test statistic: F = 57.3551 
Degrees of freedom 1: 6 
Degrees of freedom 2: 1445.95 
p-value: 0 

Explanatory measure of effect size: 0.2 
Bootstrap CI: [0.17; 0.23]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#for exact p-value:</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>wrs2<span class="sc">$</span>p.value <span class="co">#&lt;- here also 0 indicating it is extremely low</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">#To determine which group is differs from each other:</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>post_hoc_bon <span class="ot">&lt;-</span> <span class="fu">lincon</span>(.pred_AI<span class="sc">~</span> detector, <span class="at">data=</span> detectors_df,<span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(post_hoc_bon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
lincon(formula = .pred_AI ~ detector, data = detectors_df, method = "bonferroni")

                              psihat ci.lower ci.upper p.value
Crossplag vs. GPTZero        0.05847  0.01842  0.09852 0.00024
Crossplag vs. HFOpenAI      -0.01064 -0.07240  0.05111 1.00000
Crossplag vs. OriginalityAI -0.19716 -0.27890 -0.11541 0.00000
Crossplag vs. Quil          -0.20073 -0.28998 -0.11148 0.00000
Crossplag vs. Sapling       -0.19560 -0.28878 -0.10242 0.00000
Crossplag vs. ZeroGPT       -0.01363 -0.06562  0.03836 1.00000
GPTZero vs. HFOpenAI        -0.06911 -0.11739 -0.02084 0.00036
GPTZero vs. OriginalityAI   -0.25563 -0.32773 -0.18352 0.00000
GPTZero vs. Quil            -0.25920 -0.33971 -0.17869 0.00000
GPTZero vs. Sapling         -0.25407 -0.33892 -0.16923 0.00000
GPTZero vs. ZeroGPT         -0.07210 -0.10702 -0.03718 0.00000
HFOpenAI vs. OriginalityAI  -0.18651 -0.27259 -0.10044 0.00000
HFOpenAI vs. Quil           -0.19009 -0.28331 -0.09686 0.00000
HFOpenAI vs. Sapling        -0.18496 -0.28195 -0.08797 0.00000
HFOpenAI vs. ZeroGPT        -0.00299 -0.06154  0.05557 1.00000
OriginalityAI vs. Quil      -0.00357 -0.11109  0.10395 1.00000
OriginalityAI vs. Sapling    0.00156 -0.10925  0.11236 1.00000
OriginalityAI vs. ZeroGPT    0.18353  0.10417  0.26289 0.00000
Quil vs. Sapling             0.00513 -0.11132  0.12157 1.00000
Quil vs. ZeroGPT             0.18710  0.10003  0.27417 0.00000
Sapling vs. ZeroGPT          0.18197  0.09089  0.27306 0.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The next is for determine which detector prediucts the most</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>comparisons <span class="ot">&lt;-</span> post_hoc_bon<span class="sc">$</span>comp[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>psihat_values <span class="ot">&lt;-</span> post_hoc_bon<span class="sc">$</span>comp[, <span class="dv">3</span>]</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame to hold the comparisons and psihat values</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>comparison_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(comparisons, psihat_values)</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(comparison_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Group1"</span>, <span class="st">"Group2"</span>, <span class="st">"psihat"</span>)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the aggregate score for each name</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>aggregate_scores <span class="ot">&lt;-</span> comparison_df <span class="sc">%&gt;%</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Group1, Group2), <span class="at">names_to =</span> <span class="st">"Group"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(value) <span class="sc">%&gt;%</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">score =</span> <span class="fu">sum</span>(<span class="fu">abs</span>(psihat)))</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Rank the names based on the aggregate scores</span></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>ranked_scores <span class="ot">&lt;-</span> aggregate_scores <span class="sc">%&gt;%</span></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(score)</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the group names</span></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>group_names <span class="ot">&lt;-</span> post_hoc_bon<span class="sc">$</span>fnames</span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame to map group indices to names</span></span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>group_mapping <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">value =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(group_names), <span class="at">name =</span> group_names)</span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the ranked scores with the group names</span></span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>ranked_scores_with_names <span class="ot">&lt;-</span> <span class="fu">merge</span>(ranked_scores, group_mapping, <span class="at">by =</span> <span class="st">"value"</span>)</span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ranked_scores_with_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  value     score          name
1     1 0.6762282     Crossplag
2     2 0.9685871       GPTZero
3     3 0.6443019      HFOpenAI
4     4 0.8279541 OriginalityAI
5     5 0.8458100          Quil
6     6 0.8232885       Sapling
7     7 0.6413155       ZeroGPT</code></pre>
</div>
</div>
<p>Although There are detectors that are significantly predicting more GPT, which one is hallucinating?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>model_2<span class="ot">&lt;-</span> <span class="fu">glm</span>(native_2 <span class="sc">~</span> .pred_AI<span class="sc">+</span> detector<span class="sc">+</span> .pred_AI<span class="sc">:</span>detector, <span class="at">data=</span> detectors_df, <span class="at">family=</span> <span class="st">"binomial"</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_baseline, model_2, <span class="at">test=</span> <span class="st">"LRT"</span>) <span class="co">#&lt;- indicating significant diffference between the nullmodel and the testmodel</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: native_2 ~ 1
Model 2: native_2 ~ .pred_AI + detector + .pred_AI:detector
  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
1      2467     2818.8                          
2      2454     1617.0 13   1201.8 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = native_2 ~ .pred_AI + detector + .pred_AI:detector, 
    family = "binomial", data = detectors_df)

Coefficients:
                               Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                     2.23787    0.18703  11.965  &lt; 2e-16 ***
.pred_AI                       -4.53956    0.47831  -9.491  &lt; 2e-16 ***
detectorGPTZero                -0.15057    0.25436  -0.592   0.5539    
detectorHFOpenAI                0.10243    0.26952   0.380   0.7039    
detectorOriginalityAI           0.70254    0.31351   2.241   0.0250 *  
detectorQuil                   -0.06504    0.31251  -0.208   0.8351    
detectorSapling                -0.47211    0.28117  -1.679   0.0931 .  
detectorZeroGPT                 0.47927    0.29604   1.619   0.1055    
.pred_AI:detectorGPTZero       -2.91069    1.19047  -2.445   0.0145 *  
.pred_AI:detectorHFOpenAI      -0.37957    0.69579  -0.546   0.5854    
.pred_AI:detectorOriginalityAI -0.52451    0.65986  -0.795   0.4267    
.pred_AI:detectorQuil          -0.51398    0.73502  -0.699   0.4844    
.pred_AI:detectorSapling        0.39375    0.68672   0.573   0.5664    
.pred_AI:detectorZeroGPT       -5.90289    1.39136  -4.243 2.21e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2818.8  on 2467  degrees of freedom
Residual deviance: 1617.0  on 2454  degrees of freedom
  (3717 observations deleted due to missingness)
AIC: 1645

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#AIC: 1644.9949</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="b-is-there-any-difference" class="level3">
<h3 class="anchored" data-anchor-id="b-is-there-any-difference">2/B is there any difference?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>model_2_b<span class="ot">&lt;-</span> <span class="fu">glm</span>(native_2 <span class="sc">~</span> .pred_AI<span class="sc">+</span>detector, <span class="at">data=</span> detectors_df, <span class="at">family=</span> <span class="st">"binomial"</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_baseline, model_2_b, <span class="at">test=</span> <span class="st">"LRT"</span>) <span class="co">#&lt;- indicating significant diffference between the nullmodel and the testmodel</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: native_2 ~ 1
Model 2: native_2 ~ .pred_AI + detector
  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
1      2467     2818.8                          
2      2460     1655.7  7   1163.1 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_2_b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = native_2 ~ .pred_AI + detector, family = "binomial", 
    data = detectors_df)

Coefficients:
                      Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)             2.4055     0.1691  14.224   &lt;2e-16 ***
.pred_AI               -5.3053     0.2182 -24.316   &lt;2e-16 ***
detectorGPTZero        -0.4645     0.2234  -2.079   0.0376 *  
detectorHFOpenAI        0.0161     0.2326   0.069   0.9448    
detectorOriginalityAI   0.6253     0.2533   2.469   0.0136 *  
detectorQuil           -0.1667     0.2636  -0.632   0.5272    
detectorSapling        -0.4414     0.2606  -1.694   0.0903 .  
detectorZeroGPT        -0.3050     0.2208  -1.381   0.1672    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2818.8  on 2467  degrees of freedom
Residual deviance: 1655.7  on 2460  degrees of freedom
  (3717 observations deleted due to missingness)
AIC: 1671.7

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co">#AIC: 1671.699</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now splitting the data into significant and non-significant detectors based on the model_2 First removing the significant detectors from the model (also the interacting ones. )</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>non_sig_pred_1 <span class="ot">&lt;-</span> detectors_df <span class="sc">%&gt;%</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(<span class="sc">!</span>detector <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"GPTZero"</span>, <span class="st">"OriginalityAI"</span>, <span class="st">"ZeroGPT"</span>))</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>model_baseline_2<span class="ot">&lt;-</span> <span class="fu">glm</span>(native_2 <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data=</span> non_sig_pred_1, <span class="at">family=</span> <span class="st">"binomial"</span>)</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>model_3<span class="ot">&lt;-</span> <span class="fu">glm</span>(native_2 <span class="sc">~</span> .pred_AI<span class="sc">+</span> detector<span class="sc">+</span> .pred_AI<span class="sc">:</span> detector, <span class="at">data=</span> non_sig_pred_1, <span class="at">family=</span> <span class="st">"binomial"</span>)</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_baseline_2, model_3, <span class="at">test=</span> <span class="st">"LRT"</span>) <span class="co">#&lt;- indicating significant diffference between the nullmodel and the testmodel</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: native_2 ~ 1
Model 2: native_2 ~ .pred_AI + detector + .pred_AI:detector
  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
1      1285    1532.42                          
2      1278     932.79  7   599.64 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = native_2 ~ .pred_AI + detector + .pred_AI:detector, 
    family = "binomial", data = non_sig_pred_1)

Coefficients:
                          Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                2.23787    0.18703  11.965   &lt;2e-16 ***
.pred_AI                  -4.53956    0.47831  -9.491   &lt;2e-16 ***
detectorHFOpenAI           0.10243    0.26952   0.380   0.7039    
detectorQuil              -0.06504    0.31251  -0.208   0.8351    
detectorSapling           -0.47211    0.28117  -1.679   0.0931 .  
.pred_AI:detectorHFOpenAI -0.37957    0.69579  -0.546   0.5854    
.pred_AI:detectorQuil     -0.51398    0.73502  -0.699   0.4844    
.pred_AI:detectorSapling   0.39375    0.68672   0.573   0.5664    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1532.42  on 1285  degrees of freedom
Residual deviance:  932.79  on 1278  degrees of freedom
  (2124 observations deleted due to missingness)
AIC: 948.79

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">#AIC: 948.78545</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Testing the OG model too:</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>model_1_1<span class="ot">&lt;-</span> <span class="fu">glm</span>(native_2 <span class="sc">~</span> .pred_AI, <span class="at">data=</span> non_sig_pred_1, <span class="at">family=</span> <span class="st">"binomial"</span>)</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_baseline_2, model_1_1, <span class="at">test=</span> <span class="st">"LRT"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: native_2 ~ 1
Model 2: native_2 ~ .pred_AI
  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
1      1285    1532.42                          
2      1284     938.24  1   594.18 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_1_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = native_2 ~ .pred_AI, family = "binomial", data = non_sig_pred_1)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   2.1607     0.1029   21.00   &lt;2e-16 ***
.pred_AI     -4.6735     0.2514  -18.59   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1532.42  on 1285  degrees of freedom
Residual deviance:  938.24  on 1284  degrees of freedom
  (2124 observations deleted due to missingness)
AIC: 942.24

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co">#AIC: 942.23976</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="co">#removing the non-significant ones</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>sig_pred_1 <span class="ot">&lt;-</span> detectors_df <span class="sc">%&gt;%</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(<span class="sc">!</span>detector <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"HFOpenAI"</span>, <span class="st">"Quil"</span>, <span class="st">"Sapling"</span>,<span class="st">"OriginalityAI"</span>))</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>model_baseline_3<span class="ot">&lt;-</span> <span class="fu">glm</span>(native_2 <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data=</span> sig_pred_1, <span class="at">family=</span> <span class="st">"binomial"</span>)</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>model_4<span class="ot">&lt;-</span> <span class="fu">glm</span>(native_2 <span class="sc">~</span> .pred_AI<span class="sc">+</span> detector<span class="sc">+</span> .pred_AI<span class="sc">:</span> detector, <span class="at">data=</span> sig_pred_1, <span class="at">family=</span> <span class="st">"binomial"</span>)</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_baseline_3, model_4, <span class="at">test=</span> <span class="st">"LRT"</span>) <span class="co">#&lt;- indicating significant diffference between the nullmodel and the testmodel</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: native_2 ~ 1
Model 2: native_2 ~ .pred_AI + detector + .pred_AI:detector
  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
1      1181    1277.60                          
2      1176     761.45  5   516.14 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = native_2 ~ .pred_AI + detector + .pred_AI:detector, 
    family = "binomial", data = sig_pred_1)

Coefficients:
                         Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                2.2379     0.1870  11.965  &lt; 2e-16 ***
.pred_AI                  -4.5396     0.4783  -9.491  &lt; 2e-16 ***
detectorGPTZero           -0.1506     0.2544  -0.592   0.5539    
detectorZeroGPT            0.4793     0.2960   1.619   0.1055    
.pred_AI:detectorGPTZero  -2.9107     1.1905  -2.445   0.0145 *  
.pred_AI:detectorZeroGPT  -5.9029     1.3914  -4.243 2.21e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1277.60  on 1181  degrees of freedom
Residual deviance:  761.45  on 1176  degrees of freedom
  (1593 observations deleted due to missingness)
AIC: 773.45

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">#AIC: 773.45435</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Testing the OG model too:</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>model_1_2<span class="ot">&lt;-</span> <span class="fu">glm</span>(native_2 <span class="sc">~</span> .pred_AI, <span class="at">data=</span> sig_pred_1, <span class="at">family=</span> <span class="st">"binomial"</span>)</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_baseline_3, model_1_2, <span class="at">test=</span> <span class="st">"LRT"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: native_2 ~ 1
Model 2: native_2 ~ .pred_AI
  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
1      1181     1277.6                          
2      1180      794.5  1    483.1 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_1_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = native_2 ~ .pred_AI, family = "binomial", data = sig_pred_1)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   2.2603     0.1076   21.01   &lt;2e-16 ***
.pred_AI     -6.1300     0.4028  -15.22   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1277.6  on 1181  degrees of freedom
Residual deviance:  794.5  on 1180  degrees of freedom
  (1593 observations deleted due to missingness)
AIC: 798.5

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC: 798.49782</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now the same model, but without interaction</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>model_5 <span class="ot">&lt;-</span> <span class="fu">glm</span>(native_2 <span class="sc">~</span> .pred_AI <span class="sc">+</span> detector, <span class="at">data=</span> detectors_df, <span class="at">family=</span> <span class="st">"binomial"</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_baseline, model_5, <span class="at">test=</span> <span class="st">"LRT"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: native_2 ~ 1
Model 2: native_2 ~ .pred_AI + detector
  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
1      2467     2818.8                          
2      2460     1655.7  7   1163.1 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = native_2 ~ .pred_AI + detector, family = "binomial", 
    data = detectors_df)

Coefficients:
                      Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)             2.4055     0.1691  14.224   &lt;2e-16 ***
.pred_AI               -5.3053     0.2182 -24.316   &lt;2e-16 ***
detectorGPTZero        -0.4645     0.2234  -2.079   0.0376 *  
detectorHFOpenAI        0.0161     0.2326   0.069   0.9448    
detectorOriginalityAI   0.6253     0.2533   2.469   0.0136 *  
detectorQuil           -0.1667     0.2636  -0.632   0.5272    
detectorSapling        -0.4414     0.2606  -1.694   0.0903 .  
detectorZeroGPT        -0.3050     0.2208  -1.381   0.1672    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2818.8  on 2467  degrees of freedom
Residual deviance: 1655.7  on 2460  degrees of freedom
  (3717 observations deleted due to missingness)
AIC: 1671.7

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC: 1671.699</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="co">#removing the significant groups</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>non_sig_pred_2 <span class="ot">&lt;-</span> detectors_df <span class="sc">%&gt;%</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(<span class="sc">!</span>detector <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"GPTZero"</span>, <span class="st">"OriginalityAI"</span>))</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>model_baseline_4 <span class="ot">&lt;-</span> <span class="fu">glm</span>(native_2 <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data=</span> non_sig_pred_2, <span class="at">family=</span> <span class="st">"binomial"</span>)</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>model_6 <span class="ot">&lt;-</span> <span class="fu">glm</span>(native_2 <span class="sc">~</span> .pred_AI <span class="sc">+</span> detector, <span class="at">data=</span> non_sig_pred_2, <span class="at">family=</span> <span class="st">"binomial"</span>)</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_baseline_4, model_6, <span class="at">test=</span> <span class="st">"LRT"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: native_2 ~ 1
Model 2: native_2 ~ .pred_AI + detector
  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
1      1679     1962.5                          
2      1674     1175.0  5   787.58 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = native_2 ~ .pred_AI + detector, family = "binomial", 
    data = non_sig_pred_2)

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       2.37524    0.16997  13.975   &lt;2e-16 ***
.pred_AI         -5.16278    0.25751 -20.049   &lt;2e-16 ***
detectorHFOpenAI  0.01684    0.22975   0.073   0.9416    
detectorQuil     -0.17347    0.25989  -0.667   0.5045    
detectorSapling  -0.43102    0.25784  -1.672   0.0946 .  
detectorZeroGPT  -0.29609    0.21875  -1.354   0.1759    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1962.5  on 1679  degrees of freedom
Residual deviance: 1174.9  on 1674  degrees of freedom
  (2655 observations deleted due to missingness)
AIC: 1186.9

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC: 1186.9468</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Testing on the OG model</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>model_7 <span class="ot">&lt;-</span> <span class="fu">glm</span>(native_2 <span class="sc">~</span> .pred_AI, <span class="at">data=</span> non_sig_pred_2, <span class="at">family=</span> <span class="st">"binomial"</span>)</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_baseline_4, model_7, <span class="at">test=</span> <span class="st">"LRT"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: native_2 ~ 1
Model 2: native_2 ~ .pred_AI
  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
1      1679     1962.5                          
2      1678     1179.7  1   782.81 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = native_2 ~ .pred_AI, family = "binomial", data = non_sig_pred_2)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  2.21369    0.09085   24.37   &lt;2e-16 ***
.pred_AI    -5.13640    0.25309  -20.30   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1962.5  on 1679  degrees of freedom
Residual deviance: 1179.7  on 1678  degrees of freedom
  (2655 observations deleted due to missingness)
AIC: 1183.7

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC: 1183.7217</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Removing the non_significant ones</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>sig_pred_2 <span class="ot">&lt;-</span> detectors_df <span class="sc">%&gt;%</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(<span class="sc">!</span>detector <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"HFOpenAI"</span>, <span class="st">"Quil"</span>, <span class="st">"Sapling"</span>, <span class="st">"ZeroGPT"</span>))</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>model_baseline_5 <span class="ot">&lt;-</span> <span class="fu">glm</span>(native_2 <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data=</span> sig_pred_2, <span class="at">family=</span> <span class="st">"binomial"</span>)</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>model_8 <span class="ot">&lt;-</span> <span class="fu">glm</span>(native_2 <span class="sc">~</span> .pred_AI<span class="sc">+</span> detector, <span class="at">data=</span> sig_pred_2, <span class="at">family=</span> <span class="st">"binomial"</span>)</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_baseline_5, model_8, <span class="at">test=</span> <span class="st">"LRT"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: native_2 ~ 1
Model 2: native_2 ~ .pred_AI + detector
  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
1      1181    1277.60                          
2      1178     774.91  3   502.69 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = native_2 ~ .pred_AI + detector, family = "binomial", 
    data = sig_pred_2)

Coefficients:
                      Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)             2.3879     0.1745  13.688   &lt;2e-16 ***
.pred_AI               -5.2223     0.3089 -16.908   &lt;2e-16 ***
detectorGPTZero        -0.4549     0.2236  -2.035   0.0419 *  
detectorOriginalityAI   0.6119     0.2533   2.415   0.0157 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1277.60  on 1181  degrees of freedom
Residual deviance:  774.91  on 1178  degrees of freedom
  (1593 observations deleted due to missingness)
AIC: 782.91

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC: 782.9127</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="co">#OG model:</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>model_9 <span class="ot">&lt;-</span> <span class="fu">glm</span>(native_2 <span class="sc">~</span> .pred_AI, <span class="at">data=</span> sig_pred_2, <span class="at">family=</span> <span class="st">"binomial"</span>)</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_baseline_5, model_9, <span class="at">test=</span> <span class="st">"LRT"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: native_2 ~ 1
Model 2: native_2 ~ .pred_AI
  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
1      1181    1277.60                          
2      1180     793.75  1   483.85 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = native_2 ~ .pred_AI, family = "binomial", data = sig_pred_2)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   2.3438     0.1122   20.89   &lt;2e-16 ***
.pred_AI     -4.9439     0.2914  -16.97   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1277.60  on 1181  degrees of freedom
Residual deviance:  793.75  on 1180  degrees of freedom
  (1593 observations deleted due to missingness)
AIC: 797.75

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  797.75039</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Which AIC value is the best?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>aic_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Model 1/A"</span>,<span class="st">"Model 1/B"</span>,<span class="st">"Model 1/C"</span>, <span class="st">"Model 2/A"</span>,<span class="st">"Model 2/B"</span>, <span class="st">"Model 3"</span>, <span class="st">"Model 4"</span>, <span class="st">"Model 5"</span>, <span class="st">"Model 6"</span>, <span class="st">"Model 7"</span>, <span class="st">"Model 8"</span>),</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">AIC =</span> <span class="fu">c</span>(model_1<span class="sc">$</span>aic, model_1_1<span class="sc">$</span>aic, model_1_2<span class="sc">$</span>aic, model_2<span class="sc">$</span>aic, model_2_b<span class="sc">$</span>aic,  model_3<span class="sc">$</span>aic, model_4<span class="sc">$</span>aic, model_5<span class="sc">$</span>aic, model_6<span class="sc">$</span>aic, model_7<span class="sc">$</span>aic, model_8<span class="sc">$</span>aic)</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>aic_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Model       AIC
1  Model 1/A 1685.8423
2  Model 1/B  942.2398
3  Model 1/C  798.4978
4  Model 2/A 1644.9949
5  Model 2/B 1671.6990
6    Model 3  948.7854
7    Model 4  773.4543
8    Model 5 1671.6990
9    Model 6 1186.9468
10   Model 7 1183.7217
11   Model 8  782.9127</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Visualising it</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify the minimum AIC value</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>aic_data<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(aic_data<span class="sc">$</span>AIC <span class="sc">==</span> <span class="fu">min</span>(aic_data<span class="sc">$</span>AIC), <span class="st">"Lowest"</span>, <span class="st">"Other"</span>)</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(aic_data, <span class="fu">aes</span>(<span class="at">x =</span> Model, <span class="at">y =</span> AIC, <span class="at">fill =</span> color)) <span class="sc">+</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"AIC Values of Different Models"</span>,</span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Model"</span>,</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"AIC"</span></span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>()</span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb125-21"><a href="#cb125-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Lowest"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Other"</span> <span class="ot">=</span> <span class="fu">viridis</span>(<span class="dv">1</span>))) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Predicting based on the .pred_AI which essay would fail, based on Decision tree</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>model_dt <span class="ot">&lt;-</span> <span class="fu">rpart</span>(name <span class="sc">~</span> .pred_AI, <span class="at">data=</span> detectors_df)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
rpart(formula = name ~ .pred_AI, data = detectors_df)
  n= 6185 

          CP nsplit rel error    xerror        xstd
1 0.07369439      0 1.0000000 1.0102515 0.005512989
2 0.01411992      1 0.9263056 0.9286267 0.006339770
3 0.01000000      2 0.9121857 0.9208897 0.006403887

Variable importance
.pred_AI 
     100 

Node number 1: 6185 observations,    complexity param=0.07369439
  predicted class=Fake CS224N - GPT3      expected loss=0.8358933  P(node) =1
    class counts:   217   217  1015  1015   637   490   725   637   616   616
   probabilities: 0.035 0.035 0.164 0.164 0.103 0.079 0.117 0.103 0.100 0.100 
  left son=2 (3796 obs) right son=3 (2389 obs)
  Primary splits:
      .pred_AI &lt; 0.03443274 to the left,  improve=191.867, (0 missing)

Node number 2: 3796 observations,    complexity param=0.01411992
  predicted class=Fake CS224N - GPT3, PE  expected loss=0.7924131  P(node) =0.6137429
    class counts:    43   200   407   788   463   428   643   118   524   182
   probabilities: 0.011 0.053 0.107 0.208 0.122 0.113 0.169 0.031 0.138 0.048 
  left son=4 (2989 obs) right son=5 (807 obs)
  Primary splits:
      .pred_AI &lt; 3.905e-07  to the right, improve=17.61341, (0 missing)

Node number 3: 2389 observations
  predicted class=Fake CS224N - GPT3      expected loss=0.7455002  P(node) =0.3862571
    class counts:   174    17   608   227   174    62    82   519    92   434
   probabilities: 0.073 0.007 0.254 0.095 0.073 0.026 0.034 0.217 0.039 0.182 

Node number 4: 2989 observations
  predicted class=Fake CS224N - GPT3, PE  expected loss=0.7791904  P(node) =0.483266
    class counts:    43   161   341   660   410   311   442   102   367   152
   probabilities: 0.014 0.054 0.114 0.221 0.137 0.104 0.148 0.034 0.123 0.051 

Node number 5: 807 observations
  predicted class=Real CS224N             expected loss=0.7509294  P(node) =0.130477
    class counts:     0    39    66   128    53   117   201    16   157    30
   probabilities: 0.000 0.048 0.082 0.159 0.066 0.145 0.249 0.020 0.195 0.037 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(model_dt, <span class="at">legend.x =</span> <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co">#More complex model (I did not add the model variable, because that doesn't make any sense, because the name of the essay implifies it too (see data) )</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>model_dt_2 <span class="ot">&lt;-</span> <span class="fu">rpart</span>(name <span class="sc">~</span> .pred_AI<span class="sc">+</span> detector, <span class="at">data=</span> detectors_df)</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_dt_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
rpart(formula = name ~ .pred_AI + detector, data = detectors_df)
  n= 6185 

          CP nsplit rel error    xerror        xstd
1 0.07369439      0 1.0000000 1.0096712 0.005519993
2 0.01392650      1 0.9263056 0.9288201 0.006338139
3 0.01000000      2 0.9123791 0.9226306 0.006389649

Variable importance
.pred_AI detector 
      82       18 

Node number 1: 6185 observations,    complexity param=0.07369439
  predicted class=Fake CS224N - GPT3      expected loss=0.8358933  P(node) =1
    class counts:   217   217  1015  1015   637   490   725   637   616   616
   probabilities: 0.035 0.035 0.164 0.164 0.103 0.079 0.117 0.103 0.100 0.100 
  left son=2 (3796 obs) right son=3 (2389 obs)
  Primary splits:
      .pred_AI &lt; 0.03443274 to the left,  improve=191.86700, (0 missing)
      detector splits as  RRRRLLR, improve= 32.47746, (0 missing)
  Surrogate splits:
      detector splits as  LLLRLLL, agree=0.619, adj=0.013, (0 split)

Node number 2: 3796 observations,    complexity param=0.0139265
  predicted class=Fake CS224N - GPT3, PE  expected loss=0.7924131  P(node) =0.6137429
    class counts:    43   200   407   788   463   428   643   118   524   182
   probabilities: 0.011 0.053 0.107 0.208 0.122 0.113 0.169 0.031 0.138 0.048 
  left son=4 (884 obs) right son=5 (2912 obs)
  Primary splits:
      detector splits as  RRRRLLR, improve=39.77893, (0 missing)
      .pred_AI &lt; 3.905e-07  to the right, improve=17.61341, (0 missing)

Node number 3: 2389 observations
  predicted class=Fake CS224N - GPT3      expected loss=0.7455002  P(node) =0.3862571
    class counts:   174    17   608   227   174    62    82   519    92   434
   probabilities: 0.073 0.007 0.254 0.095 0.073 0.026 0.034 0.217 0.039 0.182 

Node number 4: 884 observations
  predicted class=Fake CS224N - GPT3, PE  expected loss=0.7545249  P(node) =0.1429264
    class counts:    13    61    82   217   147   127     0    35   139    63
   probabilities: 0.015 0.069 0.093 0.245 0.166 0.144 0.000 0.040 0.157 0.071 

Node number 5: 2912 observations
  predicted class=Real CS224N             expected loss=0.7791896  P(node) =0.4708165
    class counts:    30   139   325   571   316   301   643    83   385   119
   probabilities: 0.010 0.048 0.112 0.196 0.109 0.103 0.221 0.029 0.132 0.041 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(model_dt_2, <span class="at">legend.x =</span> <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Comparing the essays and the prediction. Hypothesis: The Fake CS224N-GPT 3 will be the worst performing (it’s .pred_AI score will be the highest) Based on the decision tree, where it was the test whichserved as a key point of decision.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Running shapiro-Wilk test to determine is the Assumption for Normality met or not</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">by</span>(detectors_df<span class="sc">$</span>.pred_AI, detectors_df<span class="sc">$</span>name, <span class="cf">function</span>(x){<span class="fu">shapiro.test</span>(x)}) <span class="co">#Violating</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>detectors_df$name: Fake College Essays - GPT3

    Shapiro-Wilk normality test

data:  x
W = 0.65534, p-value &lt; 2.2e-16

------------------------------------------------------------ 
detectors_df$name: Fake College Essays - GPT3 Prompt Engineered

    Shapiro-Wilk normality test

data:  x
W = 0.2526, p-value &lt; 2.2e-16

------------------------------------------------------------ 
detectors_df$name: Fake CS224N - GPT3

    Shapiro-Wilk normality test

data:  x
W = 0.72986, p-value &lt; 2.2e-16

------------------------------------------------------------ 
detectors_df$name: Fake CS224N - GPT3, PE

    Shapiro-Wilk normality test

data:  x
W = 0.48305, p-value &lt; 2.2e-16

------------------------------------------------------------ 
detectors_df$name: Fake TOEFL - GPT4 - PE

    Shapiro-Wilk normality test

data:  x
W = 0.54117, p-value &lt; 2.2e-16

------------------------------------------------------------ 
detectors_df$name: Real College Essays

    Shapiro-Wilk normality test

data:  x
W = 0.33912, p-value &lt; 2.2e-16

------------------------------------------------------------ 
detectors_df$name: Real CS224N

    Shapiro-Wilk normality test

data:  x
W = 0.29319, p-value &lt; 2.2e-16

------------------------------------------------------------ 
detectors_df$name: Real TOEFL

    Shapiro-Wilk normality test

data:  x
W = 0.81445, p-value &lt; 2.2e-16

------------------------------------------------------------ 
detectors_df$name: US 8th grade essay

    Shapiro-Wilk normality test

data:  x
W = 0.36492, p-value &lt; 2.2e-16

------------------------------------------------------------ 
detectors_df$name: US 8th grade essay - GPT simplify

    Shapiro-Wilk normality test

data:  x
W = 0.75247, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Running Levene's test to determine if the Equality of Variances met. </span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(.pred_AI <span class="sc">~</span> name, <span class="at">data=</span> detectors_df) <span class="co">#Violating</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
        Df F value    Pr(&gt;F)    
group    9  255.06 &lt; 2.2e-16 ***
      6175                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Running Welch test on rangnumbers =robust versionof the Welch test) </span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>rW_2 <span class="ot">&lt;-</span> <span class="fu">t1way</span>(.pred_AI <span class="sc">~</span> name, <span class="at">data=</span> detectors_df, <span class="at">tr=</span><span class="fl">0.2</span>)</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rW_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
t1way(formula = .pred_AI ~ name, data = detectors_df, tr = 0.2)

Test statistic: F = 187.3562 
Degrees of freedom 1: 9 
Degrees of freedom 2: 1229.06 
p-value: 0 

Explanatory measure of effect size: 0.57 
Bootstrap CI: [0.54; 0.6]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>post_hoc_bon_2 <span class="ot">&lt;-</span> <span class="fu">lincon</span>(.pred_AI<span class="sc">~</span> name, <span class="at">data=</span> detectors_df,<span class="at">method =</span> <span class="st">"bonferroni"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "For faster execution time but less power, use kbcon"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(post_hoc_bon_2) <span class="co">#&lt;- Fake College Essay Performed the worst</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
lincon(formula = .pred_AI ~ name, data = detectors_df, method = "bonferroni")

                                                                                     psihat
Fake College Essays - GPT3 vs. Fake College Essays - GPT3 Prompt Engineered         0.82427
Fake College Essays - GPT3 vs. Fake CS224N - GPT3                                   0.41969
Fake College Essays - GPT3 vs. Fake CS224N - GPT3, PE                               0.81989
Fake College Essays - GPT3 vs. Fake TOEFL - GPT4 - PE                               0.80946
Fake College Essays - GPT3 vs. Real College Essays                                  0.82415
Fake College Essays - GPT3 vs. Real CS224N                                          0.82403
Fake College Essays - GPT3 vs. Real TOEFL                                           0.17318
Fake College Essays - GPT3 vs. US 8th grade essay                                   0.82393
Fake College Essays - GPT3 vs. US 8th grade essay - GPT simplify                    0.21863
Fake College Essays - GPT3 Prompt Engineered vs. Fake CS224N - GPT3                -0.40457
Fake College Essays - GPT3 Prompt Engineered vs. Fake CS224N - GPT3, PE            -0.00438
Fake College Essays - GPT3 Prompt Engineered vs. Fake TOEFL - GPT4 - PE            -0.01481
Fake College Essays - GPT3 Prompt Engineered vs. Real College Essays               -0.00012
Fake College Essays - GPT3 Prompt Engineered vs. Real CS224N                       -0.00024
Fake College Essays - GPT3 Prompt Engineered vs. Real TOEFL                        -0.65108
Fake College Essays - GPT3 Prompt Engineered vs. US 8th grade essay                -0.00033
Fake College Essays - GPT3 Prompt Engineered vs. US 8th grade essay - GPT simplify -0.60563
Fake CS224N - GPT3 vs. Fake CS224N - GPT3, PE                                       0.40019
Fake CS224N - GPT3 vs. Fake TOEFL - GPT4 - PE                                       0.38977
Fake CS224N - GPT3 vs. Real College Essays                                          0.40445
Fake CS224N - GPT3 vs. Real CS224N                                                  0.40433
Fake CS224N - GPT3 vs. Real TOEFL                                                  -0.24651
Fake CS224N - GPT3 vs. US 8th grade essay                                           0.40424
Fake CS224N - GPT3 vs. US 8th grade essay - GPT simplify                           -0.20106
Fake CS224N - GPT3, PE vs. Fake TOEFL - GPT4 - PE                                  -0.01043
Fake CS224N - GPT3, PE vs. Real College Essays                                      0.00426
Fake CS224N - GPT3, PE vs. Real CS224N                                              0.00414
Fake CS224N - GPT3, PE vs. Real TOEFL                                              -0.64670
Fake CS224N - GPT3, PE vs. US 8th grade essay                                       0.00405
Fake CS224N - GPT3, PE vs. US 8th grade essay - GPT simplify                       -0.60125
Fake TOEFL - GPT4 - PE vs. Real College Essays                                      0.01469
Fake TOEFL - GPT4 - PE vs. Real CS224N                                              0.01457
Fake TOEFL - GPT4 - PE vs. Real TOEFL                                              -0.63628
Fake TOEFL - GPT4 - PE vs. US 8th grade essay                                       0.01448
Fake TOEFL - GPT4 - PE vs. US 8th grade essay - GPT simplify                       -0.59083
Real College Essays vs. Real CS224N                                                -0.00012
Real College Essays vs. Real TOEFL                                                 -0.65097
Real College Essays vs. US 8th grade essay                                         -0.00021
Real College Essays vs. US 8th grade essay - GPT simplify                          -0.60552
Real CS224N vs. Real TOEFL                                                         -0.65085
Real CS224N vs. US 8th grade essay                                                 -0.00009
Real CS224N vs. US 8th grade essay - GPT simplify                                  -0.60540
Real TOEFL vs. US 8th grade essay                                                   0.65075
Real TOEFL vs. US 8th grade essay - GPT simplify                                    0.04545
US 8th grade essay vs. US 8th grade essay - GPT simplify                           -0.60530
                                                                                   ci.lower
Fake College Essays - GPT3 vs. Fake College Essays - GPT3 Prompt Engineered         0.67923
Fake College Essays - GPT3 vs. Fake CS224N - GPT3                                   0.25808
Fake College Essays - GPT3 vs. Fake CS224N - GPT3, PE                               0.67514
Fake College Essays - GPT3 vs. Fake TOEFL - GPT4 - PE                               0.66368
Fake College Essays - GPT3 vs. Real College Essays                                  0.67911
Fake College Essays - GPT3 vs. Real CS224N                                          0.67899
Fake College Essays - GPT3 vs. Real TOEFL                                           0.00893
Fake College Essays - GPT3 vs. US 8th grade essay                                   0.67890
Fake College Essays - GPT3 vs. US 8th grade essay - GPT simplify                    0.04829
Fake College Essays - GPT3 Prompt Engineered vs. Fake CS224N - GPT3                -0.47710
Fake College Essays - GPT3 Prompt Engineered vs. Fake CS224N - GPT3, PE            -0.00870
Fake College Essays - GPT3 Prompt Engineered vs. Fake TOEFL - GPT4 - PE            -0.03141
Fake College Essays - GPT3 Prompt Engineered vs. Real College Essays               -0.00035
Fake College Essays - GPT3 Prompt Engineered vs. Real CS224N                       -0.00055
Fake College Essays - GPT3 Prompt Engineered vs. Real TOEFL                        -0.72973
Fake College Essays - GPT3 Prompt Engineered vs. US 8th grade essay                -0.00077
Fake College Essays - GPT3 Prompt Engineered vs. US 8th grade essay - GPT simplify -0.69641
Fake CS224N - GPT3 vs. Fake CS224N - GPT3, PE                                       0.32753
Fake CS224N - GPT3 vs. Fake TOEFL - GPT4 - PE                                       0.31536
Fake CS224N - GPT3 vs. Real College Essays                                          0.33192
Fake CS224N - GPT3 vs. Real CS224N                                                  0.33180
Fake CS224N - GPT3 vs. Real TOEFL                                                  -0.35330
Fake CS224N - GPT3 vs. US 8th grade essay                                           0.33171
Fake CS224N - GPT3 vs. US 8th grade essay - GPT simplify                           -0.31691
Fake CS224N - GPT3, PE vs. Fake TOEFL - GPT4 - PE                                  -0.02756
Fake CS224N - GPT3, PE vs. Real College Essays                                     -0.00007
Fake CS224N - GPT3, PE vs. Real CS224N                                             -0.00019
Fake CS224N - GPT3, PE vs. Real TOEFL                                              -0.72556
Fake CS224N - GPT3, PE vs. US 8th grade essay                                      -0.00029
Fake CS224N - GPT3, PE vs. US 8th grade essay - GPT simplify                       -0.69220
Fake TOEFL - GPT4 - PE vs. Real College Essays                                     -0.00190
Fake TOEFL - GPT4 - PE vs. Real CS224N                                             -0.00202
Fake TOEFL - GPT4 - PE vs. Real TOEFL                                              -0.71660
Fake TOEFL - GPT4 - PE vs. US 8th grade essay                                      -0.00212
Fake TOEFL - GPT4 - PE vs. US 8th grade essay - GPT simplify                       -0.68295
Real College Essays vs. Real CS224N                                                -0.00049
Real College Essays vs. Real TOEFL                                                 -0.72961
Real College Essays vs. US 8th grade essay                                         -0.00070
Real College Essays vs. US 8th grade essay - GPT simplify                          -0.69630
Real CS224N vs. Real TOEFL                                                         -0.72949
Real CS224N vs. US 8th grade essay                                                 -0.00062
Real CS224N vs. US 8th grade essay - GPT simplify                                  -0.69618
Real TOEFL vs. US 8th grade essay                                                   0.57210
Real TOEFL vs. US 8th grade essay - GPT simplify                                   -0.07424
US 8th grade essay vs. US 8th grade essay - GPT simplify                           -0.69608
                                                                                   ci.upper
Fake College Essays - GPT3 vs. Fake College Essays - GPT3 Prompt Engineered         0.96930
Fake College Essays - GPT3 vs. Fake CS224N - GPT3                                   0.58131
Fake College Essays - GPT3 vs. Fake CS224N - GPT3, PE                               0.96463
Fake College Essays - GPT3 vs. Fake TOEFL - GPT4 - PE                               0.95524
Fake College Essays - GPT3 vs. Real College Essays                                  0.96918
Fake College Essays - GPT3 vs. Real CS224N                                          0.96906
Fake College Essays - GPT3 vs. Real TOEFL                                           0.33743
Fake College Essays - GPT3 vs. US 8th grade essay                                   0.96897
Fake College Essays - GPT3 vs. US 8th grade essay - GPT simplify                    0.38897
Fake College Essays - GPT3 Prompt Engineered vs. Fake CS224N - GPT3                -0.33204
Fake College Essays - GPT3 Prompt Engineered vs. Fake CS224N - GPT3, PE            -0.00006
Fake College Essays - GPT3 Prompt Engineered vs. Fake TOEFL - GPT4 - PE             0.00179
Fake College Essays - GPT3 Prompt Engineered vs. Real College Essays                0.00011
Fake College Essays - GPT3 Prompt Engineered vs. Real CS224N                        0.00007
Fake College Essays - GPT3 Prompt Engineered vs. Real TOEFL                        -0.57244
Fake College Essays - GPT3 Prompt Engineered vs. US 8th grade essay                 0.00011
Fake College Essays - GPT3 Prompt Engineered vs. US 8th grade essay - GPT simplify -0.51485
Fake CS224N - GPT3 vs. Fake CS224N - GPT3, PE                                       0.47285
Fake CS224N - GPT3 vs. Fake TOEFL - GPT4 - PE                                       0.46417
Fake CS224N - GPT3 vs. Real College Essays                                          0.47699
Fake CS224N - GPT3 vs. Real CS224N                                                  0.47687
Fake CS224N - GPT3 vs. Real TOEFL                                                  -0.13973
Fake CS224N - GPT3 vs. US 8th grade essay                                           0.47678
Fake CS224N - GPT3 vs. US 8th grade essay - GPT simplify                           -0.08521
Fake CS224N - GPT3, PE vs. Fake TOEFL - GPT4 - PE                                   0.00670
Fake CS224N - GPT3, PE vs. Real College Essays                                      0.00859
Fake CS224N - GPT3, PE vs. Real CS224N                                              0.00847
Fake CS224N - GPT3, PE vs. Real TOEFL                                              -0.56785
Fake CS224N - GPT3, PE vs. US 8th grade essay                                       0.00839
Fake CS224N - GPT3, PE vs. US 8th grade essay - GPT simplify                       -0.51031
Fake TOEFL - GPT4 - PE vs. Real College Essays                                      0.03128
Fake TOEFL - GPT4 - PE vs. Real CS224N                                              0.03116
Fake TOEFL - GPT4 - PE vs. Real TOEFL                                              -0.55596
Fake TOEFL - GPT4 - PE vs. US 8th grade essay                                       0.03107
Fake TOEFL - GPT4 - PE vs. US 8th grade essay - GPT simplify                       -0.49870
Real College Essays vs. Real CS224N                                                 0.00025
Real College Essays vs. Real TOEFL                                                 -0.57232
Real College Essays vs. US 8th grade essay                                          0.00028
Real College Essays vs. US 8th grade essay - GPT simplify                          -0.51473
Real CS224N vs. Real TOEFL                                                         -0.57220
Real CS224N vs. US 8th grade essay                                                  0.00044
Real CS224N vs. US 8th grade essay - GPT simplify                                  -0.51461
Real TOEFL vs. US 8th grade essay                                                   0.72940
Real TOEFL vs. US 8th grade essay - GPT simplify                                    0.16514
US 8th grade essay vs. US 8th grade essay - GPT simplify                           -0.51452
                                                                                   p.value
Fake College Essays - GPT3 vs. Fake College Essays - GPT3 Prompt Engineered        0.00000
Fake College Essays - GPT3 vs. Fake CS224N - GPT3                                  0.00000
Fake College Essays - GPT3 vs. Fake CS224N - GPT3, PE                              0.00000
Fake College Essays - GPT3 vs. Fake TOEFL - GPT4 - PE                              0.00000
Fake College Essays - GPT3 vs. Real College Essays                                 0.00000
Fake College Essays - GPT3 vs. Real CS224N                                         0.00000
Fake College Essays - GPT3 vs. Real TOEFL                                          0.06038
Fake College Essays - GPT3 vs. US 8th grade essay                                  0.00000
Fake College Essays - GPT3 vs. US 8th grade essay - GPT simplify                   0.00456
Fake College Essays - GPT3 Prompt Engineered vs. Fake CS224N - GPT3                0.00000
Fake College Essays - GPT3 Prompt Engineered vs. Fake CS224N - GPT3, PE            0.09080
Fake College Essays - GPT3 Prompt Engineered vs. Fake TOEFL - GPT4 - PE            0.29434
Fake College Essays - GPT3 Prompt Engineered vs. Real College Essays               1.00000
Fake College Essays - GPT3 Prompt Engineered vs. Real CS224N                       0.77414
Fake College Essays - GPT3 Prompt Engineered vs. Real TOEFL                        0.00000
Fake College Essays - GPT3 Prompt Engineered vs. US 8th grade essay                1.00000
Fake College Essays - GPT3 Prompt Engineered vs. US 8th grade essay - GPT simplify 0.00000
Fake CS224N - GPT3 vs. Fake CS224N - GPT3, PE                                      0.00000
Fake CS224N - GPT3 vs. Fake TOEFL - GPT4 - PE                                      0.00000
Fake CS224N - GPT3 vs. Real College Essays                                         0.00000
Fake CS224N - GPT3 vs. Real CS224N                                                 0.00000
Fake CS224N - GPT3 vs. Real TOEFL                                                  0.00000
Fake CS224N - GPT3 vs. US 8th grade essay                                          0.00000
Fake CS224N - GPT3 vs. US 8th grade essay - GPT simplify                           0.00001
Fake CS224N - GPT3, PE vs. Fake TOEFL - GPT4 - PE                                  1.00000
Fake CS224N - GPT3, PE vs. Real College Essays                                     0.12125
Fake CS224N - GPT3, PE vs. Real CS224N                                             0.16077
Fake CS224N - GPT3, PE vs. Real TOEFL                                              0.00000
Fake CS224N - GPT3, PE vs. US 8th grade essay                                      0.20179
Fake CS224N - GPT3, PE vs. US 8th grade essay - GPT simplify                       0.00000
Fake TOEFL - GPT4 - PE vs. Real College Essays                                     0.31441
Fake TOEFL - GPT4 - PE vs. Real CS224N                                             0.33583
Fake TOEFL - GPT4 - PE vs. Real TOEFL                                              0.00000
Fake TOEFL - GPT4 - PE vs. US 8th grade essay                                      0.35343
Fake TOEFL - GPT4 - PE vs. US 8th grade essay - GPT simplify                       0.00000
Real College Essays vs. Real CS224N                                                1.00000
Real College Essays vs. Real TOEFL                                                 0.00000
Real College Essays vs. US 8th grade essay                                         1.00000
Real College Essays vs. US 8th grade essay - GPT simplify                          0.00000
Real CS224N vs. Real TOEFL                                                         0.00000
Real CS224N vs. US 8th grade essay                                                 1.00000
Real CS224N vs. US 8th grade essay - GPT simplify                                  0.00000
Real TOEFL vs. US 8th grade essay                                                  0.00000
Real TOEFL vs. US 8th grade essay - GPT simplify                                   1.00000
US 8th grade essay vs. US 8th grade essay - GPT simplify                           0.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>comparisons_2 <span class="ot">&lt;-</span> post_hoc_bon_2<span class="sc">$</span>comp[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>psihat_values_2 <span class="ot">&lt;-</span> post_hoc_bon_2<span class="sc">$</span>comp[, <span class="dv">3</span>]</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame for comparisons and psihat values</span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>comparison_df_2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(comparisons_2, psihat_values_2)</span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(comparison_df_2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Group1"</span>, <span class="st">"Group2"</span>, <span class="st">"psihat"</span>)</span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the aggregated score for each name</span></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>aggregate_scores_2 <span class="ot">&lt;-</span> comparison_df_2 <span class="sc">%&gt;%</span></span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Group1, Group2), <span class="at">names_to =</span> <span class="st">"Group"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(value) <span class="sc">%&gt;%</span></span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">score =</span> <span class="fu">sum</span>(<span class="fu">abs</span>(psihat)))</span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Rank the names based on the aggregate scores</span></span>
<span id="cb142-15"><a href="#cb142-15" aria-hidden="true" tabindex="-1"></a>ranked_scores_2 <span class="ot">&lt;-</span> aggregate_scores_2 <span class="sc">%&gt;%</span></span>
<span id="cb142-16"><a href="#cb142-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(score)</span>
<span id="cb142-17"><a href="#cb142-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-18"><a href="#cb142-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Group names extraction</span></span>
<span id="cb142-19"><a href="#cb142-19" aria-hidden="true" tabindex="-1"></a>group_names_2 <span class="ot">&lt;-</span> post_hoc_bon_2<span class="sc">$</span>fnames</span>
<span id="cb142-20"><a href="#cb142-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-21"><a href="#cb142-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame to map group indices to names</span></span>
<span id="cb142-22"><a href="#cb142-22" aria-hidden="true" tabindex="-1"></a>group_mapping_2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">value =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(group_names_2), <span class="at">name =</span> group_names_2)</span>
<span id="cb142-23"><a href="#cb142-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-24"><a href="#cb142-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the ranked scores with the group names</span></span>
<span id="cb142-25"><a href="#cb142-25" aria-hidden="true" tabindex="-1"></a>ranked_scores_with_names_2 <span class="ot">&lt;-</span> <span class="fu">merge</span>(ranked_scores_2, group_mapping_2, <span class="at">by =</span> <span class="st">"value"</span>)</span>
<span id="cb142-26"><a href="#cb142-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-27"><a href="#cb142-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-28"><a href="#cb142-28" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ranked_scores_with_names_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   value    score                                         name
1      1 5.737222                   Fake College Essays - GPT3
2      2 2.505434 Fake College Essays - GPT3 Prompt Engineered
3      3 3.274827                           Fake CS224N - GPT3
4      4 2.495296                       Fake CS224N - GPT3, PE
5      5 2.495296                       Fake TOEFL - GPT4 - PE
6      6 2.504481                          Real College Essays
7      7 2.503762                                  Real CS224N
8      8 4.351773                                   Real TOEFL
9      9 2.503395                           US 8th grade essay
10    10 4.079071            US 8th grade essay - GPT simplify</code></pre>
</div>
</div>
<p>Investigating the previous decision tree, but now I am curious, whether the same pattern would appear, if I filter the data to only real essays, written by real people</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(detectors_df<span class="sc">$</span>name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                  Fake College Essays - GPT3 
                                         217 
Fake College Essays - GPT3 Prompt Engineered 
                                         217 
                          Fake CS224N - GPT3 
                                        1015 
                      Fake CS224N - GPT3, PE 
                                        1015 
                      Fake TOEFL - GPT4 - PE 
                                         637 
                         Real College Essays 
                                         490 
                                 Real CS224N 
                                         725 
                                  Real TOEFL 
                                         637 
                          US 8th grade essay 
                                         616 
           US 8th grade essay - GPT simplify 
                                         616 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>real_essay <span class="ot">&lt;-</span> detectors_df <span class="sc">%&gt;%</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(<span class="sc">!</span>name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Fake College Essays - GPT3"</span>, </span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"Fake CS224N - GPT3"</span>, </span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"Fake TOEFL - GPT4 - PE"</span>,</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"Fake College Essays - GPT3 Prompt Engineered "</span>,</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"Fake CS224N - GPT3, PE"</span>,</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"US 8th grade essay - GPT simplify"</span>))</span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>model_dt_real_essay <span class="ot">&lt;-</span> <span class="fu">rpart</span>(name <span class="sc">~</span> .pred_AI, <span class="at">data=</span> real_essay)</span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_dt_real_essay)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
rpart(formula = name ~ .pred_AI, data = real_essay)
  n= 2685 

          CP nsplit rel error    xerror       xstd
1 0.20510204      0 1.0000000 1.0000000 0.01173732
2 0.01581633      1 0.7948980 0.7954082 0.01304560
3 0.01428571      2 0.7790816 0.7969388 0.01304074
4 0.01000000      4 0.7505102 0.7658163 0.01312617

Variable importance
.pred_AI 
     100 

Node number 1: 2685 observations,    complexity param=0.205102
  predicted class=Real CS224N         expected loss=0.7299814  P(node) =1
    class counts:     0   217     0     0     0   490   725   637   616
   probabilities: 0.000 0.081 0.000 0.000 0.000 0.182 0.270 0.237 0.229 
  left son=2 (2163 obs) right son=3 (522 obs)
  Primary splits:
      .pred_AI &lt; 0.3369768   to the left,  improve=286.3284, (0 missing)

Node number 2: 2163 observations,    complexity param=0.01581633
  predicted class=Real CS224N         expected loss=0.6777624  P(node) =0.8055866
    class counts:     0   208     0     0     0   477   697   207   574
   probabilities: 0.000 0.096 0.000 0.000 0.000 0.221 0.322 0.096 0.265 
  left son=4 (1787 obs) right son=5 (376 obs)
  Primary splits:
      .pred_AI &lt; 0.007377546 to the left,  improve=34.54234, (0 missing)

Node number 3: 522 observations
  predicted class=Real TOEFL          expected loss=0.1762452  P(node) =0.1944134
    class counts:     0     9     0     0     0    13    28   430    42
   probabilities: 0.000 0.017 0.000 0.000 0.000 0.025 0.054 0.824 0.080 

Node number 4: 1787 observations,    complexity param=0.01428571
  predicted class=Real CS224N         expected loss=0.6642417  P(node) =0.6655493
    class counts:     0   198     0     0     0   407   600    79   503
   probabilities: 0.000 0.111 0.000 0.000 0.000 0.228 0.336 0.044 0.281 
  left son=8 (1487 obs) right son=9 (300 obs)
  Primary splits:
      .pred_AI &lt; 2.365e-56   to the right, improve=7.17101, (0 missing)

Node number 5: 376 observations
  predicted class=Real TOEFL          expected loss=0.6595745  P(node) =0.1400372
    class counts:     0    10     0     0     0    70    97   128    71
   probabilities: 0.000 0.027 0.000 0.000 0.000 0.186 0.258 0.340 0.189 

Node number 8: 1487 observations,    complexity param=0.01428571
  predicted class=Real CS224N         expected loss=0.6886348  P(node) =0.5538175
    class counts:     0   177     0     0     0   354   463    65   428
   probabilities: 0.000 0.119 0.000 0.000 0.000 0.238 0.311 0.044 0.288 
  left son=16 (1376 obs) right son=17 (111 obs)
  Primary splits:
      .pred_AI &lt; 3.52e-15    to the right, improve=23.71275, (0 missing)

Node number 9: 300 observations
  predicted class=Real CS224N         expected loss=0.5433333  P(node) =0.1117318
    class counts:     0    21     0     0     0    53   137    14    75
   probabilities: 0.000 0.070 0.000 0.000 0.000 0.177 0.457 0.047 0.250 

Node number 16: 1376 observations
  predicted class=Real CS224N         expected loss=0.6656977  P(node) =0.5124767
    class counts:     0   177     0     0     0   305   460    65   369
   probabilities: 0.000 0.129 0.000 0.000 0.000 0.222 0.334 0.047 0.268 

Node number 17: 111 observations
  predicted class=US 8th grade essay  expected loss=0.4684685  P(node) =0.04134078
    class counts:     0     0     0     0     0    49     3     0    59
   probabilities: 0.000 0.000 0.000 0.000 0.000 0.441 0.027 0.000 0.532 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(model_dt_real_essay, <span class="at">legend.x =</span> <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co">#More complex model (I did not add the model variable, because that doesn't make any sense, because the name of the essay implifies it too (see data) )</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>model_dt_real_essay_2 <span class="ot">&lt;-</span> <span class="fu">rpart</span>(name <span class="sc">~</span> .pred_AI<span class="sc">+</span> detector, <span class="at">data=</span> real_essay)</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_dt_real_essay_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
rpart(formula = name ~ .pred_AI + detector, data = real_essay)
  n= 2685 

          CP nsplit rel error    xerror       xstd
1 0.20510204      0 1.0000000 1.0000000 0.01173732
2 0.08265306      1 0.7948980 0.7959184 0.01304399
3 0.01258503      2 0.7122449 0.7132653 0.01320732
4 0.01020408      5 0.6744898 0.6846939 0.01321862
5 0.01000000      6 0.6642857 0.6755102 0.01321736

Variable importance
.pred_AI detector 
      81       19 

Node number 1: 2685 observations,    complexity param=0.205102
  predicted class=Real CS224N         expected loss=0.7299814  P(node) =1
    class counts:     0   217     0     0     0   490   725   637   616
   probabilities: 0.000 0.081 0.000 0.000 0.000 0.182 0.270 0.237 0.229 
  left son=2 (2163 obs) right son=3 (522 obs)
  Primary splits:
      .pred_AI &lt; 0.3369768   to the left,  improve=286.32840, (0 missing)
      detector splits as  LLLLRRL, improve= 65.99105, (0 missing)

Node number 2: 2163 observations,    complexity param=0.08265306
  predicted class=Real CS224N         expected loss=0.6777624  P(node) =0.8055866
    class counts:     0   208     0     0     0   477   697   207   574
   probabilities: 0.000 0.096 0.000 0.000 0.000 0.221 0.322 0.096 0.265 
  left son=4 (410 obs) right son=5 (1753 obs)
  Primary splits:
      detector splits as  RRRRLLR, improve=69.62586, (0 missing)
      .pred_AI &lt; 0.007377546 to the left,  improve=34.54234, (0 missing)

Node number 3: 522 observations
  predicted class=Real TOEFL          expected loss=0.1762452  P(node) =0.1944134
    class counts:     0     9     0     0     0    13    28   430    42
   probabilities: 0.000 0.017 0.000 0.000 0.000 0.025 0.054 0.824 0.080 

Node number 4: 410 observations
  predicted class=US 8th grade essay  expected loss=0.604878  P(node) =0.1527002
    class counts:     0    62     0     0     0   138     0    48   162
   probabilities: 0.000 0.151 0.000 0.000 0.000 0.337 0.000 0.117 0.395 

Node number 5: 1753 observations,    complexity param=0.01258503
  predicted class=Real CS224N         expected loss=0.6023959  P(node) =0.6528864
    class counts:     0   146     0     0     0   339   697   159   412
   probabilities: 0.000 0.083 0.000 0.000 0.000 0.193 0.398 0.091 0.235 
  left son=10 (1456 obs) right son=11 (297 obs)
  Primary splits:
      .pred_AI &lt; 0.008230521 to the left,  improve=33.4136100, (0 missing)
      detector splits as  RRRL--R, improve= 0.6470469, (0 missing)

Node number 10: 1456 observations,    complexity param=0.01258503
  predicted class=Real CS224N         expected loss=0.584478  P(node) =0.5422719
    class counts:     0   138     0     0     0   286   605    53   374
   probabilities: 0.000 0.095 0.000 0.000 0.000 0.196 0.416 0.036 0.257 
  left son=20 (997 obs) right son=21 (459 obs)
  Primary splits:
      .pred_AI &lt; 9.255e-11   to the right, improve=10.312310, (0 missing)
      detector splits as  LRLL--R, improve= 1.896739, (0 missing)
  Surrogate splits:
      detector splits as  LLLL--R, agree=0.891, adj=0.654, (0 split)

Node number 11: 297 observations,    complexity param=0.01020408
  predicted class=Real TOEFL          expected loss=0.6430976  P(node) =0.1106145
    class counts:     0     8     0     0     0    53    92   106    38
   probabilities: 0.000 0.027 0.000 0.000 0.000 0.178 0.310 0.357 0.128 
  left son=22 (74 obs) right son=23 (223 obs)
  Primary splits:
      detector splits as  RRRL--R, improve=6.740061, (0 missing)
      .pred_AI &lt; 0.09694149  to the right, improve=2.770722, (0 missing)
  Surrogate splits:
      .pred_AI &lt; 0.3261864   to the right, agree=0.758, adj=0.027, (0 split)

Node number 20: 997 observations
  predicted class=Real CS224N         expected loss=0.5456369  P(node) =0.3713222
    class counts:     0   108     0     0     0   173   453    39   224
   probabilities: 0.000 0.108 0.000 0.000 0.000 0.174 0.454 0.039 0.225 

Node number 21: 459 observations,    complexity param=0.01258503
  predicted class=Real CS224N         expected loss=0.6688453  P(node) =0.1709497
    class counts:     0    30     0     0     0   113   152    14   150
   probabilities: 0.000 0.065 0.000 0.000 0.000 0.246 0.331 0.031 0.327 
  left son=42 (300 obs) right son=43 (159 obs)
  Primary splits:
      .pred_AI &lt; 2.365e-56   to the left,  improve=23.1813, (0 missing)
      detector splits as  -R----L, improve=23.1813, (0 missing)

Node number 22: 74 observations
  predicted class=Real CS224N         expected loss=0.5675676  P(node) =0.02756052
    class counts:     0     1     0     0     0    22    32    12     7
   probabilities: 0.000 0.014 0.000 0.000 0.000 0.297 0.432 0.162 0.095 

Node number 23: 223 observations
  predicted class=Real TOEFL          expected loss=0.5784753  P(node) =0.083054
    class counts:     0     7     0     0     0    31    60    94    31
   probabilities: 0.000 0.031 0.000 0.000 0.000 0.139 0.269 0.422 0.139 

Node number 42: 300 observations
  predicted class=Real CS224N         expected loss=0.5433333  P(node) =0.1117318
    class counts:     0    21     0     0     0    53   137    14    75
   probabilities: 0.000 0.070 0.000 0.000 0.000 0.177 0.457 0.047 0.250 

Node number 43: 159 observations
  predicted class=US 8th grade essay  expected loss=0.5283019  P(node) =0.05921788
    class counts:     0     9     0     0     0    60    15     0    75
   probabilities: 0.000 0.057 0.000 0.000 0.000 0.377 0.094 0.000 0.472 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(model_dt_real_essay_2, <span class="at">legend.x =</span> <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Based on both tree the Real TOEFL is detected as AI written</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>#The same, but now with the Fake essays</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(detectors_df<span class="sc">$</span>name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                  Fake College Essays - GPT3 
                                         217 
Fake College Essays - GPT3 Prompt Engineered 
                                         217 
                          Fake CS224N - GPT3 
                                        1015 
                      Fake CS224N - GPT3, PE 
                                        1015 
                      Fake TOEFL - GPT4 - PE 
                                         637 
                         Real College Essays 
                                         490 
                                 Real CS224N 
                                         725 
                                  Real TOEFL 
                                         637 
                          US 8th grade essay 
                                         616 
           US 8th grade essay - GPT simplify 
                                         616 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>fake_essay <span class="ot">&lt;-</span> detectors_df <span class="sc">%&gt;%</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(<span class="sc">!</span>name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Real CS224N"</span>, </span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"US 8th grade essay"</span>, </span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"Real College Essays"</span>,</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"Real TOEFL"</span>))</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>model_dt_fake_essay <span class="ot">&lt;-</span> <span class="fu">rpart</span>(name <span class="sc">~</span> .pred_AI, <span class="at">data=</span> fake_essay)</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_dt_fake_essay)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
rpart(formula = name ~ .pred_AI, data = fake_essay)
  n= 3717 

         CP nsplit rel error    xerror        xstd
1 0.1380459      0 1.0000000 1.0255366 0.009828386
2 0.0100000      1 0.8619541 0.8678756 0.010888470

Variable importance
.pred_AI 
     100 

Node number 1: 3717 observations,    complexity param=0.1380459
  predicted class=Fake CS224N - GPT3      expected loss=0.7269303  P(node) =1
    class counts:   217   217  1015  1015   637     0     0     0     0   616
   probabilities: 0.058 0.058 0.273 0.273 0.171 0.000 0.000 0.000 0.000 0.166 
  left son=2 (2136 obs) right son=3 (1581 obs)
  Primary splits:
      .pred_AI &lt; 0.0483252 to the left,  improve=136.2508, (0 missing)

Node number 2: 2136 observations
  predicted class=Fake CS224N - GPT3, PE  expected loss=0.6240637  P(node) =0.574657
    class counts:    45   200   430   803   473     0     0     0     0   185
   probabilities: 0.021 0.094 0.201 0.376 0.221 0.000 0.000 0.000 0.000 0.087 

Node number 3: 1581 observations
  predicted class=Fake CS224N - GPT3      expected loss=0.629981  P(node) =0.425343
    class counts:   172    17   585   212   164     0     0     0     0   431
   probabilities: 0.109 0.011 0.370 0.134 0.104 0.000 0.000 0.000 0.000 0.273 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(model_dt_fake_essay , <span class="at">legend.x =</span> <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co">#More complex model (I did not add the model variable, because that doesn't make any sense, because the name of the essay implifies it too (see data) )</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>model_dt_fake_essay_2 <span class="ot">&lt;-</span> <span class="fu">rpart</span>(name <span class="sc">~</span> .pred_AI<span class="sc">+</span> detector, <span class="at">data=</span> fake_essay)</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_dt_fake_essay_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
rpart(formula = name ~ .pred_AI + detector, data = fake_essay)
  n= 3717 

         CP nsplit rel error    xerror        xstd
1 0.1380459      0 1.0000000 1.0133235 0.009938628
2 0.0100000      1 0.8619541 0.8667654 0.010893393

Variable importance
.pred_AI detector 
      94        6 

Node number 1: 3717 observations,    complexity param=0.1380459
  predicted class=Fake CS224N - GPT3      expected loss=0.7269303  P(node) =1
    class counts:   217   217  1015  1015   637     0     0     0     0   616
   probabilities: 0.058 0.058 0.273 0.273 0.171 0.000 0.000 0.000 0.000 0.166 
  left son=2 (2136 obs) right son=3 (1581 obs)
  Primary splits:
      .pred_AI &lt; 0.0483252 to the left,  improve=136.2508, (0 missing)
  Surrogate splits:
      detector splits as  LLLRLLL, agree=0.601, adj=0.063, (0 split)

Node number 2: 2136 observations
  predicted class=Fake CS224N - GPT3, PE  expected loss=0.6240637  P(node) =0.574657
    class counts:    45   200   430   803   473     0     0     0     0   185
   probabilities: 0.021 0.094 0.201 0.376 0.221 0.000 0.000 0.000 0.000 0.087 

Node number 3: 1581 observations
  predicted class=Fake CS224N - GPT3      expected loss=0.629981  P(node) =0.425343
    class counts:   172    17   585   212   164     0     0     0     0   431
   probabilities: 0.109 0.011 0.370 0.134 0.104 0.000 0.000 0.000 0.000 0.273 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(model_dt_fake_essay_2, <span class="at">legend.x =</span> <span class="cn">NA</span>)</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="co">#The worst performing  is Fake CS224N-GPT3, it is predicted with higher chances as AI, whereas, Fake CS224N- GPT3,, PE is the best. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Validation remove the non native people from the sample. Due to the reason, that they are predicted more as AI. (See first point) NOTE: here is only the baseline model is investigated</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>non_native <span class="ot">&lt;-</span> detectors_df <span class="sc">%&gt;%</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(<span class="sc">!</span>native <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Yes"</span>))</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>model_non_native<span class="ot">&lt;-</span> <span class="fu">rpart</span>(name <span class="sc">~</span> .pred_AI, <span class="at">data=</span> non_native)</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_non_native)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
rpart(formula = name ~ .pred_AI, data = non_native)
  n= 4354 

         CP nsplit rel error    xerror        xstd
1 0.1141060      0 1.0000000 1.0170710 0.008186645
2 0.0131776      1 0.8858940 0.8903863 0.009196735
3 0.0100000      3 0.8595388 0.8814016 0.009249069

Variable importance
.pred_AI 
     100 

Node number 1: 4354 observations,    complexity param=0.114106
  predicted class=Fake CS224N - GPT3      expected loss=0.766881  P(node) =1
    class counts:   217   217  1015  1015   637     0     0   637     0   616
   probabilities: 0.050 0.050 0.233 0.233 0.146 0.000 0.000 0.146 0.000 0.141 
  left son=2 (2201 obs) right son=3 (2153 obs)
  Primary splits:
      .pred_AI &lt; 0.03443274 to the left,  improve=163.2479, (0 missing)

Node number 2: 2201 observations
  predicted class=Fake CS224N - GPT3, PE  expected loss=0.6419809  P(node) =0.5055122
    class counts:    43   200   407   788   463     0     0   118     0   182
   probabilities: 0.020 0.091 0.185 0.358 0.210 0.000 0.000 0.054 0.000 0.083 

Node number 3: 2153 observations,    complexity param=0.0131776
  predicted class=Fake CS224N - GPT3      expected loss=0.7176033  P(node) =0.4944878
    class counts:   174    17   608   227   174     0     0   519     0   434
   probabilities: 0.081 0.008 0.282 0.105 0.081 0.000 0.000 0.241 0.000 0.202 
  left son=6 (890 obs) right son=7 (1263 obs)
  Primary splits:
      .pred_AI &lt; 0.9786177  to the right, improve=21.66162, (0 missing)

Node number 6: 890 observations
  predicted class=Fake CS224N - GPT3      expected loss=0.6516854  P(node) =0.2044097
    class counts:   103     0   310    54    22     0     0   181     0   220
   probabilities: 0.116 0.000 0.348 0.061 0.025 0.000 0.000 0.203 0.000 0.247 

Node number 7: 1263 observations,    complexity param=0.0131776
  predicted class=Real TOEFL              expected loss=0.7323832  P(node) =0.2900781
    class counts:    71    17   298   173   152     0     0   338     0   214
   probabilities: 0.056 0.013 0.236 0.137 0.120 0.000 0.000 0.268 0.000 0.169 
  left son=14 (528 obs) right son=15 (735 obs)
  Primary splits:
      .pred_AI &lt; 0.3771974  to the left,  improve=10.27665, (0 missing)

Node number 14: 528 observations
  predicted class=Fake CS224N - GPT3      expected loss=0.7102273  P(node) =0.1212678
    class counts:    20     9   153    87    83     0     0   105     0    71
   probabilities: 0.038 0.017 0.290 0.165 0.157 0.000 0.000 0.199 0.000 0.134 

Node number 15: 735 observations
  predicted class=Real TOEFL              expected loss=0.6829932  P(node) =0.1688103
    class counts:    51     8   145    86    69     0     0   233     0   143
   probabilities: 0.069 0.011 0.197 0.117 0.094 0.000 0.000 0.317 0.000 0.195 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(model_non_native,<span class="at">legend.x =</span> <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>model_native_2<span class="ot">&lt;-</span> <span class="fu">rpart</span>(name <span class="sc">~</span> .pred_AI<span class="sc">+</span> detector, <span class="at">data=</span> non_native)</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_native_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
rpart(formula = name ~ .pred_AI + detector, data = non_native)
  n= 4354 

          CP nsplit rel error    xerror        xstd
1 0.11410602      0 1.0000000 1.0092842 0.008265171
2 0.01197963      1 0.8858940 0.8879904 0.009210916
3 0.01000000      2 0.8739143 0.8912848 0.009191374

Variable importance
.pred_AI detector 
      86       14 

Node number 1: 4354 observations,    complexity param=0.114106
  predicted class=Fake CS224N - GPT3      expected loss=0.766881  P(node) =1
    class counts:   217   217  1015  1015   637     0     0   637     0   616
   probabilities: 0.050 0.050 0.233 0.233 0.146 0.000 0.000 0.146 0.000 0.141 
  left son=2 (2201 obs) right son=3 (2153 obs)
  Primary splits:
      .pred_AI &lt; 0.03443274 to the left,  improve=163.2479, (0 missing)
  Surrogate splits:
      detector splits as  LLLRRLR, agree=0.577, adj=0.145, (0 split)

Node number 2: 2201 observations
  predicted class=Fake CS224N - GPT3, PE  expected loss=0.6419809  P(node) =0.5055122
    class counts:    43   200   407   788   463     0     0   118     0   182
   probabilities: 0.020 0.091 0.185 0.358 0.210 0.000 0.000 0.054 0.000 0.083 

Node number 3: 2153 observations,    complexity param=0.01197963
  predicted class=Fake CS224N - GPT3      expected loss=0.7176033  P(node) =0.4944878
    class counts:   174    17   608   227   174     0     0   519     0   434
   probabilities: 0.081 0.008 0.282 0.105 0.081 0.000 0.000 0.241 0.000 0.202 
  left son=6 (890 obs) right son=7 (1263 obs)
  Primary splits:
      .pred_AI &lt; 0.9786177  to the right, improve=21.661620, (0 missing)
      detector splits as  LRLLLLR, improve= 9.430255, (0 missing)
  Surrogate splits:
      detector splits as  RRRRLLR, agree=0.699, adj=0.272, (0 split)

Node number 6: 890 observations
  predicted class=Fake CS224N - GPT3      expected loss=0.6516854  P(node) =0.2044097
    class counts:   103     0   310    54    22     0     0   181     0   220
   probabilities: 0.116 0.000 0.348 0.061 0.025 0.000 0.000 0.203 0.000 0.247 

Node number 7: 1263 observations
  predicted class=Real TOEFL              expected loss=0.7323832  P(node) =0.2900781
    class counts:    71    17   298   173   152     0     0   338     0   214
   probabilities: 0.056 0.013 0.236 0.137 0.120 0.000 0.000 0.268 0.000 0.169 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(model_native_2 , <span class="at">legend.x =</span> <span class="cn">NA</span>) <span class="co">#&lt;- detector variable is not contributing much in the importance (14%)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Native</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>native <span class="ot">&lt;-</span> detectors_df <span class="sc">%&gt;%</span></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(native <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Yes"</span>))</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>model_native<span class="ot">&lt;-</span> <span class="fu">rpart</span>(name <span class="sc">~</span> .pred_AI, <span class="at">data=</span> native)</span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_native)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
rpart(formula = name ~ .pred_AI, data = native)
  n= 1831 

          CP nsplit rel error    xerror       xstd
1 0.02531646      0 1.0000000 1.0000000 0.01892114
2 0.01537071      2 0.9493671 0.9683544 0.01906348
3 0.01000000      4 0.9186257 0.9593128 0.01909870

Variable importance
.pred_AI 
     100 

Node number 1: 1831 observations,    complexity param=0.02531646
  predicted class=Real CS224N          expected loss=0.6040415  P(node) =1
    class counts:     0     0     0     0     0   490   725     0   616
   probabilities: 0.000 0.000 0.000 0.000 0.000 0.268 0.396 0.000 0.336 
  left son=2 (265 obs) right son=3 (1566 obs)
  Primary splits:
      .pred_AI &lt; 2.365e-56 to the left,  improve=6.838432, (0 missing)

Node number 2: 265 observations
  predicted class=Real CS224N          expected loss=0.4830189  P(node) =0.1447297
    class counts:     0     0     0     0     0    53   137     0    75
   probabilities: 0.000 0.000 0.000 0.000 0.000 0.200 0.517 0.000 0.283 

Node number 3: 1566 observations,    complexity param=0.02531646
  predicted class=Real CS224N          expected loss=0.6245211  P(node) =0.8552703
    class counts:     0     0     0     0     0   437   588     0   541
   probabilities: 0.000 0.000 0.000 0.000 0.000 0.279 0.375 0.000 0.345 
  left son=6 (1455 obs) right son=7 (111 obs)
  Primary splits:
      .pred_AI &lt; 3.52e-15  to the right, improve=21.79198, (0 missing)

Node number 6: 1455 observations,    complexity param=0.01537071
  predicted class=Real CS224N          expected loss=0.5979381  P(node) =0.7946477
    class counts:     0     0     0     0     0   388   585     0   482
   probabilities: 0.000 0.000 0.000 0.000 0.000 0.267 0.402 0.000 0.331 
  left son=12 (99 obs) right son=13 (1356 obs)
  Primary splits:
      .pred_AI &lt; 3.945e-07 to the left,  improve=7.317968, (0 missing)

Node number 7: 111 observations
  predicted class=US 8th grade essay   expected loss=0.4684685  P(node) =0.06062261
    class counts:     0     0     0     0     0    49     3     0    59
   probabilities: 0.000 0.000 0.000 0.000 0.000 0.441 0.027 0.000 0.532 

Node number 12: 99 observations
  predicted class=Real CS224N          expected loss=0.3838384  P(node) =0.05406881
    class counts:     0     0     0     0     0    15    61     0    23
   probabilities: 0.000 0.000 0.000 0.000 0.000 0.152 0.616 0.000 0.232 

Node number 13: 1356 observations,    complexity param=0.01537071
  predicted class=Real CS224N          expected loss=0.6135693  P(node) =0.7405789
    class counts:     0     0     0     0     0   373   524     0   459
   probabilities: 0.000 0.000 0.000 0.000 0.000 0.275 0.386 0.000 0.338 
  left son=26 (1285 obs) right son=27 (71 obs)
  Primary splits:
      .pred_AI &lt; 1.93e-06  to the right, improve=14.84304, (0 missing)

Node number 26: 1285 observations
  predicted class=Real CS224N          expected loss=0.5937743  P(node) =0.7018023
    class counts:     0     0     0     0     0   337   522     0   426
   probabilities: 0.000 0.000 0.000 0.000 0.000 0.262 0.406 0.000 0.332 

Node number 27: 71 observations
  predicted class=Real College Essays  expected loss=0.4929577  P(node) =0.03877662
    class counts:     0     0     0     0     0    36     2     0    33
   probabilities: 0.000 0.000 0.000 0.000 0.000 0.507 0.028 0.000 0.465 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(model_native , <span class="at">legend.x =</span> <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-15-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>model_native_2<span class="ot">&lt;-</span> <span class="fu">rpart</span>(name <span class="sc">~</span> .pred_AI<span class="sc">+</span> detector, <span class="at">data=</span> native)</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_native_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
rpart(formula = name ~ .pred_AI + detector, data = native)
  n= 1831 

          CP nsplit rel error    xerror       xstd
1 0.15913201      0 1.0000000 1.0000000 0.01892114
2 0.02712477      1 0.8408680 0.8408680 0.01934214
3 0.01000000      3 0.7866184 0.7866184 0.01932066

Variable importance
detector .pred_AI 
      77       23 

Node number 1: 1831 observations,    complexity param=0.159132
  predicted class=Real CS224N         expected loss=0.6040415  P(node) =1
    class counts:     0     0     0     0     0   490   725     0   616
   probabilities: 0.000 0.000 0.000 0.000 0.000 0.268 0.396 0.000 0.336 
  left son=2 (1515 obs) right son=3 (316 obs)
  Primary splits:
      detector splits as  LLLLRRL, improve=90.204500, (0 missing)
      .pred_AI &lt; 2.365e-56 to the left,  improve= 6.838432, (0 missing)
  Surrogate splits:
      .pred_AI &lt; 0.9993107 to the left,  agree=0.829, adj=0.006, (0 split)

Node number 2: 1515 observations,    complexity param=0.02712477
  predicted class=Real CS224N         expected loss=0.5214521  P(node) =0.8274167
    class counts:     0     0     0     0     0   350   725     0   440
   probabilities: 0.000 0.000 0.000 0.000 0.000 0.231 0.479 0.000 0.290 
  left son=4 (1100 obs) right son=5 (415 obs)
  Primary splits:
      .pred_AI &lt; 9.255e-11 to the right, improve=11.06195, (0 missing)
  Surrogate splits:
      detector splits as  LLLL--R, agree=0.876, adj=0.547, (0 split)

Node number 3: 316 observations
  predicted class=US 8th grade essay  expected loss=0.443038  P(node) =0.1725833
    class counts:     0     0     0     0     0   140     0     0   176
   probabilities: 0.000 0.000 0.000 0.000 0.000 0.443 0.000 0.000 0.557 

Node number 4: 1100 observations
  predicted class=Real CS224N         expected loss=0.4790909  P(node) =0.6007646
    class counts:     0     0     0     0     0   237   573     0   290
   probabilities: 0.000 0.000 0.000 0.000 0.000 0.215 0.521 0.000 0.264 

Node number 5: 415 observations,    complexity param=0.02712477
  predicted class=Real CS224N         expected loss=0.6337349  P(node) =0.2266521
    class counts:     0     0     0     0     0   113   152     0   150
   probabilities: 0.000 0.000 0.000 0.000 0.000 0.272 0.366 0.000 0.361 
  left son=10 (265 obs) right son=11 (150 obs)
  Primary splits:
      detector splits as  -R----L, improve=24.995, (0 missing)
      .pred_AI &lt; 2.365e-56 to the left,  improve=24.995, (0 missing)
  Surrogate splits:
      .pred_AI &lt; 2.365e-56 to the left,  agree=1, adj=1, (0 split)

Node number 10: 265 observations
  predicted class=Real CS224N         expected loss=0.4830189  P(node) =0.1447297
    class counts:     0     0     0     0     0    53   137     0    75
   probabilities: 0.000 0.000 0.000 0.000 0.000 0.200 0.517 0.000 0.283 

Node number 11: 150 observations
  predicted class=US 8th grade essay  expected loss=0.5  P(node) =0.08192245
    class counts:     0     0     0     0     0    60    15     0    75
   probabilities: 0.000 0.000 0.000 0.000 0.000 0.400 0.100 0.000 0.500 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(model_native_2 , <span class="at">legend.x =</span> <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-15-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="key-takeaway" class="level1">
<h1>Key takeaway</h1>
<ul>
<li><p>People, who are non-native English speaker, are diagnosed more as AI, than the native people. This finding is crucial, for lecturers/teachers/examiners, who are using AI detectors, because the detector could haallucinate the writer as AI.</p></li>
<li><p>Based on the ANOVA (more correctly: rang-Welch test’s post-hoc comparison with Bonferroni-correction), the detector which gave the most prediction was GPTZero, with 0.98 score (see the code for details)</p></li>
<li><p>Creating more logistic model to determine which given predictor has the most influence on the response variable: Model_4: native_2 ~ .pred_AI+ detector+ .pred_AI: detector, data= sig_pred_1, family= “binomial”. NOTE: here I removed the non-significant detectors based on the native_2 ~ .pred_AI+detector, data= detectors_df, family= “binomial” model.</p></li>
<li><p>The first decision tree is the simple model. Based onm the results we can say, if the predicted AI is larger than 0.034 it’s like to be the Fake CS224N- GPT3 essay. In the more complex model I added detector to, howeever the importance of the detector is 18% and .pred_A is 82%.</p></li>
<li><p>Based on The rang-welch test the detectors are detectuiing the Fake College Essays - GPT3 as AI the most.</p></li>
<li><p>Based ont he Decision tree model the Real TOEFL was predicted the most as AI.</p></li>
<li><p>Based on the Decision tree model the Fake CS224N- GPT3 was predicted as AI the most.</p></li>
<li><p>Based on the Decision tree model the Real TOEFL &nbsp;was predicted as AI the most among non-native people.</p></li>
<li><p>Among native the US 8th grader essay.</p></li>
<li><p><strong>The results indicating the the AI detectors are not perfect. It detects US 8th grader essays as AI, indicating the detectors are looking for patterns in the data, which are more typical among adults.</strong></p></li>
<li><p><strong>Furthermore the TOEFL which was written by real people are tend to score higher on AI detectors, because it is made specifically for foreign students, who do not write naturally or the words required by the test, are may not typical among everyday speakers.</strong></p></li>
</ul>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>